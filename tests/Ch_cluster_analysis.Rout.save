
R version 2.9.0 (2009-04-17)
Copyright (C) 2009 The R Foundation for Statistical Computing
ISBN 3-900051-07-0

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> ###################################################
> ### chunk number 1: setup
> ###################################################
> rm(list = ls())
> if (!file.exists("tables")) dir.create("tables")
> set.seed(290875)
> options(prompt = "R> ", continue = "+  ",
+     width = 63, # digits = 4,
+     show.signif.stars = FALSE,
+     SweaveHooks = list(leftpar = function()
+         par(mai = par("mai") * c(1, 1.05, 1, 1)),
+         bigleftpar = function()
+         par(mai = par("mai") * c(1, 1.7, 1, 1))))
R> HSAURpkg <- require("HSAUR2")
Loading required package: HSAUR2
Loading required package: lattice
Loading required package: MASS
Loading required package: scatterplot3d
R> if (!HSAURpkg) stop("cannot load package ", sQuote("HSAUR2"))
R> rm(HSAURpkg)
R>  ### </FIXME> hm, R-2.4.0 --vanilla seems to need this
R> a <- Sys.setlocale("LC_ALL", "C")
R>  ### </FIXME>
R> book <- TRUE
R> refs <- cbind(c("AItR", "DAGD", "SI", "CI", "ANOVA", "MLR", "GLM",
+                  "DE", "RP", "GAM", "SA", "ALDI", "ALDII", "SIMC", "MA", "PCA",
+                  "MDS", "CA"), 1:18)
R> ch <- function(x) {
+      ch <- refs[which(refs[,1] == x),]
+      if (book) {
+          return(paste("Chapter~\\\\ref{", ch[1], "}", sep = ""))
+      } else {
+          return(paste("Chapter~", ch[2], sep = ""))
+      }
+  }
R> if (file.exists("deparse.R"))
+      source("deparse.R")
R> setHook(packageEvent("lattice", "attach"), function(...) {
+      lattice.options(default.theme =
+          function()
+              standard.theme("pdf", color = FALSE))
+      })
R> 
R> 
R> ###################################################
R> ### chunk number 2: singlebook
R> ###################################################
R> book <- FALSE
R> 
R> 
R> ###################################################
R> ### chunk number 3: thissetup
R> ###################################################
R> library("mclust")
by using mclust, you accept the license agreement in the LICENSE file
and at http://www.stat.washington.edu/mclust/license.txt
R> library("mvtnorm")
R> mai <- par("mai")
R> options(SweaveHooks = list(rmai = function() { par(mai = mai * c(1,1,1,2))}))
R> 
R> 
R> ###################################################
R> ### chunk number 4: CA-pottery-dist
R> ###################################################
R> pottery_dist <- dist(pottery[, colnames(pottery) != "kiln"])
R> library("lattice")
R> levelplot(as.matrix(pottery_dist), xlab = "Pot Number",
+            ylab = "Pot Number")
R> 
R> 
R> ###################################################
R> ### chunk number 5: CA-pottery-distplot
R> ###################################################
R> trellis.par.set(standard.theme(color = FALSE))
R> plot(levelplot(as.matrix(pottery_dist), xlab = "Pot Number", ylab = "Pot Number"))
R> 
R> 
R> ###################################################
R> ### chunk number 6: CA-pottery-hclust
R> ###################################################
R> pottery_single <- hclust(pottery_dist, method = "single")
R> pottery_complete <- hclust(pottery_dist, method = "complete")
R> pottery_average <- hclust(pottery_dist, method = "average")
R> layout(matrix(1:3, ncol = 3))
R> plot(pottery_single, main = "Single Linkage",
+       sub = "", xlab = "")
R> plot(pottery_complete, main = "Complete Linkage",
+       sub = "", xlab = "")
R> plot(pottery_average, main = "Average Linkage",
+       sub = "", xlab = "")
R> 
R> 
R> ###################################################
R> ### chunk number 7: pottery-cluster
R> ###################################################
R> pottery_cluster <- cutree(pottery_average, h = 4)
R> xtabs(~ pottery_cluster + kiln, data = pottery)
               kiln
pottery_cluster  1  2  3  4  5
              1 21  0  0  0  0
              2  0 12  2  0  0
              3  0  0  0  5  5
R> 
R> 
R> ###################################################
R> ### chunk number 8: CA-planets-scatter
R> ###################################################
R> data("planets", package = "HSAUR2")
R> library("scatterplot3d")
R> scatterplot3d(log(planets$mass), log(planets$period),
+      log(planets$eccen), type = "h", angle = 55,
+      pch = 16, y.ticklabs = seq(0, 10, by = 2),
+      y.margin.add = 0.1, scale.y = 0.7)
R> 
R> 
R> ###################################################
R> ### chunk number 9: CA-planet-ss
R> ###################################################
R> rge <- apply(planets, 2, max) - apply(planets, 2, min)
R> planet.dat <- sweep(planets, 2, rge, FUN = "/")
R> n <- nrow(planet.dat)
R> wss <- rep(0, 10)
R> wss[1] <- (n - 1) * sum(apply(planet.dat, 2, var))
R> for (i in 2:10)
+      wss[i] <- sum(kmeans(planet.dat,
+                           centers = i)$withinss)
R> plot(1:10, wss, type = "b", xlab = "Number of groups",
+       ylab = "Within groups sum of squares")
R> 
R> 
R> ###################################################
R> ### chunk number 10: CA-planets-kmeans3
R> ###################################################
R> planet_kmeans3 <- kmeans(planet.dat, centers = 3)
R> table(planet_kmeans3$cluster)

 1  2  3 
14 53 34 
R> 
R> 
R> ###################################################
R> ### chunk number 11: CA-planets-ccent
R> ###################################################
R> ccent <- function(cl) {
+      f <- function(i) colMeans(planets[cl == i,])
+      x <- sapply(sort(unique(cl)), f)
+      colnames(x) <- sort(unique(cl))
+      return(x)
+  }
R> 
R> 
R> ###################################################
R> ### chunk number 12: CA-planets--kmeans3-ccent
R> ###################################################
R> ccent(planet_kmeans3$cluster)
                1           2           3
mass     10.56786   1.6710566   2.9276471
period 1693.17201 427.7105892 616.0760882
eccen     0.36650   0.1219491   0.4953529
R> 
R> 
R> ###################################################
R> ### chunk number 13: CA-planets-kmeans5
R> ###################################################
R> planet_kmeans5 <- kmeans(planet.dat, centers = 5)
R> table(planet_kmeans5$cluster)

 1  2  3  4  5 
32 14  8 17 30 
R> ccent(planet_kmeans5$cluster)
                1            2           3           4
mass     1.668750   10.8121429    2.066250   3.6735294
period 402.082219 1318.6505856 2403.687500 674.9115294
eccen    0.302875    0.3836429    0.191625   0.6094706
                5
mass     1.743533
period 176.297374
eccen    0.049310
R> 
R> 
R> ###################################################
R> ### chunk number 14: CA-planets-mclust
R> ###################################################
R> library("mclust")
R> planet_mclust <- Mclust(planet.dat)
R> 
R> 
R> ###################################################
R> ### chunk number 15: CA-planets-mclust-plot
R> ###################################################
R> plot(planet_mclust, planet.dat, what = "BIC", col = "black",
+       ylab = "-BIC", ylim = c(0, 350))
R> 
R> 
R> ###################################################
R> ### chunk number 16: CA-planets-mclust-print
R> ###################################################
R> print(planet_mclust)

 best model: diagonal, varying volume and shape with 3 components
R> 
R> 
R> ###################################################
R> ### chunk number 17: CA-planets-mclust-scatter
R> ###################################################
R> clPairs(planet.dat,
+      classification = planet_mclust$classification,
+      symbols = 1:3, col = "black")
R> 
R> 
R> ###################################################
R> ### chunk number 18: CA-planets-mclust-scatterclust
R> ###################################################
R> scatterplot3d(log(planets$mass), log(planets$period),
+      log(planets$eccen), type = "h", angle = 55,
+      scale.y = 0.7, pch = planet_mclust$classification,
+      y.ticklabs = seq(0, 10, by = 2), y.margin.add = 0.1)
R> 
R> 
R> ###################################################
R> ### chunk number 19: CA-planets-mclust-mu
R> ###################################################
R> table(planet_mclust$classification)

 1  2  3 
19 41 41 
R> ccent(planet_mclust$classification)
                1           2            3
mass   1.16652632   1.5797561    6.0761463
period 6.47180158 313.4127073 1325.5310048
eccen  0.03652632   0.3061463    0.3704951
R> 
R> 
R> 
