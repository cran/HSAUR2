
R version 2.9.0 (2009-04-17)
Copyright (C) 2009 The R Foundation for Statistical Computing
ISBN 3-900051-07-0

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> ###################################################
> ### chunk number 1: setup
> ###################################################
> rm(list = ls())
> if (!file.exists("tables")) dir.create("tables")
> set.seed(290875)
> options(prompt = "R> ", continue = "+  ",
+     width = 63, # digits = 4,
+     show.signif.stars = FALSE,
+     SweaveHooks = list(leftpar = function()
+         par(mai = par("mai") * c(1, 1.05, 1, 1)),
+         bigleftpar = function()
+         par(mai = par("mai") * c(1, 1.7, 1, 1))))
R> HSAURpkg <- require("HSAUR2")
Loading required package: HSAUR2
Loading required package: lattice
Loading required package: MASS
Loading required package: scatterplot3d
R> if (!HSAURpkg) stop("cannot load package ", sQuote("HSAUR2"))
R> rm(HSAURpkg)
R>  ### </FIXME> hm, R-2.4.0 --vanilla seems to need this
R> a <- Sys.setlocale("LC_ALL", "C")
R>  ### </FIXME>
R> book <- TRUE
R> refs <- cbind(c("AItR", "DAGD", "SI", "CI", "ANOVA", "MLR", "GLM",
+                  "DE", "RP", "GAM", "SA", "ALDI", "ALDII", "SIMC", "MA", "PCA",
+                  "MDS", "CA"), 1:18)
R> ch <- function(x) {
+      ch <- refs[which(refs[,1] == x),]
+      if (book) {
+          return(paste("Chapter~\\\\ref{", ch[1], "}", sep = ""))
+      } else {
+          return(paste("Chapter~", ch[2], sep = ""))
+      }
+  }
R> if (file.exists("deparse.R"))
+      source("deparse.R")
R> setHook(packageEvent("lattice", "attach"), function(...) {
+      lattice.options(default.theme =
+          function()
+              standard.theme("pdf", color = FALSE))
+      })
R> 
R> 
R> ###################################################
R> ### chunk number 2: singlebook
R> ###################################################
R> book <- FALSE
R> 
R> 
R> ###################################################
R> ### chunk number 3: ANOVA-weightgain-mean-var
R> ###################################################
R> data("weightgain", package = "HSAUR2")
R> tapply(weightgain$weightgain,
+         list(weightgain$source, weightgain$type), mean)
        High  Low
Beef   100.0 79.2
Cereal  85.9 83.9
R> tapply(weightgain$weightgain,
+         list(weightgain$source, weightgain$type), sd)
           High      Low
Beef   15.13642 13.88684
Cereal 15.02184 15.70881
R> 
R> 
R> ###################################################
R> ### chunk number 4: ANOVA-weightgain-plot
R> ###################################################
R> plot.design(weightgain)
R> 
R> 
R> ###################################################
R> ### chunk number 5: ANOVA-weightgain-aov
R> ###################################################
R> wg_aov <- aov(weightgain ~ source * type, data = weightgain)
R> 
R> 
R> ###################################################
R> ### chunk number 6: ANOVA-weightgain-aov-summary
R> ###################################################
R> summary(wg_aov)
            Df Sum Sq Mean Sq F value  Pr(>F)
source       1  220.9   220.9  0.9879 0.32688
type         1 1299.6  1299.6  5.8123 0.02114
source:type  1  883.6   883.6  3.9518 0.05447
Residuals   36 8049.4   223.6                
R> 
R> 
R> ###################################################
R> ### chunk number 7: ANOVA-weightgain-iplot eval=FALSE
R> ###################################################
R> ## interaction.plot(weightgain$type, weightgain$source,
R> ##                  weightgain$weightgain)
R> 
R> 
R> ###################################################
R> ### chunk number 8: ANOVA-weightgain-iplot-nice
R> ###################################################
R> interaction.plot(weightgain$type, weightgain$source, weightgain$weightgain,
+  legend = FALSE)
R> legend(1.5, 95, legend = levels(weightgain$source), title = "weightgain$source",
+         lty = c(2,1), bty = "n")
R> 
R> 
R> ###################################################
R> ### chunk number 9: ANOVA-weightgain-coef
R> ###################################################
R> coef(wg_aov)
         (Intercept)         sourceCereal              typeLow 
               100.0                -14.1                -20.8 
sourceCereal:typeLow 
                18.8 
R> 
R> 
R> ###################################################
R> ### chunk number 10: ANOVA-weightgain-contrasts
R> ###################################################
R> options("contrasts")
$contrasts
        unordered           ordered 
"contr.treatment"      "contr.poly" 

R> 
R> 
R> ###################################################
R> ### chunk number 11: ANOVA-weightgain-coef-sum
R> ###################################################
R> coef(aov(weightgain ~ source + type + source:type,
+      data = weightgain, contrasts = list(source = contr.sum)))
    (Intercept)         source1         typeLow 
          92.95            7.05          -11.40 
source1:typeLow 
          -9.40 
R> 
R> 
R> ###################################################
R> ### chunk number 12: ANOVA-foster
R> ###################################################
R> data("foster", package = "HSAUR2")
R> 
R> 
R> ###################################################
R> ### chunk number 13: ANOVA-foster-plot
R> ###################################################
R> plot.design(foster)
R> 
R> 
R> ###################################################
R> ### chunk number 14: ANOVA-foster-aov-one eval=FALSE
R> ###################################################
R> ## summary(aov(weight ~ litgen * motgen, data = foster))
R> 
R> 
R> ###################################################
R> ### chunk number 15: ANOVA-foster-aov-one
R> ###################################################
R> summary(aov(weight ~ litgen * motgen, data = foster))
              Df  Sum Sq Mean Sq F value   Pr(>F)
litgen         3   60.16   20.05  0.3697 0.775221
motgen         3  775.08  258.36  4.7632 0.005736
litgen:motgen  9  824.07   91.56  1.6881 0.120053
Residuals     45 2440.82   54.24                 
R> 
R> 
R> ###################################################
R> ### chunk number 16: ANOVA-foster-aov-two eval=FALSE
R> ###################################################
R> ## summary(aov(weight ~ motgen * litgen, data = foster))
R> 
R> 
R> ###################################################
R> ### chunk number 17: ANOVA-foster-aov-two
R> ###################################################
R> summary(aov(weight ~ motgen * litgen, data = foster))
              Df  Sum Sq Mean Sq F value   Pr(>F)
motgen         3  771.61  257.20  4.7419 0.005869
litgen         3   63.63   21.21  0.3911 0.760004
motgen:litgen  9  824.07   91.56  1.6881 0.120053
Residuals     45 2440.82   54.24                 
R> 
R> 
R> ###################################################
R> ### chunk number 18: ANOVA-weightgain-again eval=FALSE
R> ###################################################
R> ## summary(aov(weightgain ~ type * source, data = weightgain))
R> 
R> 
R> ###################################################
R> ### chunk number 19: ANOVA-foster-aov
R> ###################################################
R> foster_aov <- aov(weight ~ litgen * motgen, data = foster)
R> 
R> 
R> ###################################################
R> ### chunk number 20: ANOVA-foster-tukeyHSD
R> ###################################################
R> foster_hsd <- TukeyHSD(foster_aov, "motgen")
R> foster_hsd
  Tukey multiple comparisons of means
    95% family-wise confidence level

Fit: aov(formula = weight ~ litgen * motgen, data = foster)

$motgen
         diff        lwr        upr     p adj
B-A  3.330369  -3.859729 10.5204672 0.6078581
I-A -1.895574  -8.841869  5.0507207 0.8853702
J-A -6.566168 -13.627285  0.4949498 0.0767540
I-B -5.225943 -12.416041  1.9641552 0.2266493
J-B -9.896537 -17.197624 -2.5954489 0.0040509
J-I -4.670593 -11.731711  2.3905240 0.3035490

R> 
R> 
R> ###################################################
R> ### chunk number 21: ANOVA-foster-tukeyHSDplot
R> ###################################################
R> plot(foster_hsd)
R> 
R> 
R> ###################################################
R> ### chunk number 22: ANOVA-water-manova
R> ###################################################
R> data("water", package = "HSAUR2")
R> summary(manova(cbind(hardness, mortality) ~ location,
+      data = water), test = "Hotelling-Lawley")
          Df Hotelling-Lawley approx F num Df den Df    Pr(>F)
location   1           0.9002  26.1062      2     58 8.217e-09
Residuals 59                                                  
R> 
R> 
R> ###################################################
R> ### chunk number 23: ANOVA-water-means
R> ###################################################
R> tapply(water$hardness, water$location, mean)
   North    South 
30.40000 69.76923 
R> tapply(water$mortality, water$location, mean)
   North    South 
1633.600 1376.808 
R> 
R> 
R> ###################################################
R> ### chunk number 24: ANOVA-skulls-data
R> ###################################################
R> data("skulls", package = "HSAUR2")
R> means <- aggregate(skulls[,c("mb", "bh", "bl", "nh")],
+                     list(epoch = skulls$epoch), mean)
R> means
    epoch       mb       bh       bl       nh
1 c4000BC 131.3667 133.6000 99.16667 50.53333
2 c3300BC 132.3667 132.7000 99.06667 50.23333
3 c1850BC 134.4667 133.8000 96.03333 50.56667
4  c200BC 135.5000 132.3000 94.53333 51.96667
5  cAD150 136.1667 130.3333 93.50000 51.36667
R> 
R> 
R> ###################################################
R> ### chunk number 25: ANOVA-skulls-fig
R> ###################################################
R> pairs(means[,-1],
+      panel = function(x, y) {
+          text(x, y, abbreviate(levels(skulls$epoch)))
+      })
R> 
R> 
R> ###################################################
R> ### chunk number 26: ANOVA-skulls-manova
R> ###################################################
R> skulls_manova <- manova(cbind(mb, bh, bl, nh) ~ epoch,
+                          data = skulls)
R> summary(skulls_manova, test = "Pillai")
           Df Pillai approx F num Df den Df    Pr(>F)
epoch       4 0.3533   3.5120     16    580 4.675e-06
Residuals 145                                        
R> summary(skulls_manova, test = "Wilks")
              Df  Wilks approx F num Df den Df   Pr(>F)
epoch       4.00 0.6636   3.9009  16.00 434.45 7.01e-07
Residuals 145.00                                       
R> summary(skulls_manova, test = "Hotelling-Lawley")
           Df Hotelling-Lawley approx F num Df den Df
epoch       4           0.4818   4.2310     16    562
Residuals 145                                        
             Pr(>F)
epoch     8.278e-08
Residuals          
R> summary(skulls_manova, test = "Roy")
           Df     Roy approx F num Df den Df    Pr(>F)
epoch       4  0.4251  15.4097      4    145 1.588e-10
Residuals 145                                         
R> 
R> 
R> ###################################################
R> ### chunk number 27: ANOVA-skulls-manova2
R> ###################################################
R> summary.aov(skulls_manova)
 Response mb :
             Df  Sum Sq Mean Sq F value    Pr(>F)
epoch         4  502.83  125.71  5.9546 0.0001826
Residuals   145 3061.07   21.11                  

 Response bh :
             Df Sum Sq Mean Sq F value  Pr(>F)
epoch         4  229.9    57.5  2.4474 0.04897
Residuals   145 3405.3    23.5                

 Response bl :
             Df Sum Sq Mean Sq F value    Pr(>F)
epoch         4  803.3   200.8  8.3057 4.636e-06
Residuals   145 3506.0    24.2                  

 Response nh :
             Df  Sum Sq Mean Sq F value Pr(>F)
epoch         4   61.20   15.30   1.507 0.2032
Residuals   145 1472.13   10.15               

R> 
R> 
R> ###################################################
R> ### chunk number 28: ANOVA-skulls-manova3
R> ###################################################
R> summary(manova(cbind(mb, bh, bl, nh) ~ epoch, data = skulls,
+                 subset = epoch %in% c("c4000BC", "c3300BC")))
          Df  Pillai approx F num Df den Df Pr(>F)
epoch      1 0.02767  0.39135      4     55  0.814
Residuals 58                                      
R> summary(manova(cbind(mb, bh, bl, nh) ~ epoch, data = skulls,
+                 subset = epoch %in% c("c4000BC", "c1850BC")))
          Df Pillai approx F num Df den Df  Pr(>F)
epoch      1 0.1876   3.1744      4     55 0.02035
Residuals 58                                      
R> summary(manova(cbind(mb, bh, bl, nh) ~ epoch, data = skulls,
+                 subset = epoch %in% c("c4000BC", "c200BC")))
          Df Pillai approx F num Df den Df    Pr(>F)
epoch      1 0.3030   5.9766      4     55 0.0004564
Residuals 58                                        
R> summary(manova(cbind(mb, bh, bl, nh) ~ epoch, data = skulls,
+                 subset = epoch %in% c("c4000BC", "cAD150")))
          Df Pillai approx F num Df den Df    Pr(>F)
epoch      1 0.3618   7.7956      4     55 4.736e-05
Residuals 58                                        
R> 
R> 
R> 
